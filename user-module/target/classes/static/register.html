<!--
 * register 页面
 *
 * @author 林佳评 代宇盛
 * @version 1.0
 * @since 2021-06-25 11:06:08
-->
<!--author 代宇盛ajax-->
<!--author：林佳评ui页面，表单验证-->
<!DOCTYPE html>
<html class="p_AFMaximized" dir="ltr" lang="zh-CN">
<head>
	<title>基线检查 | 创建帐户</title>
	<link data-afr-stylesheet="true" rel="stylesheet" charset="UTF-8" type="text/css" href="register/css/myprofile-skin-desktop-edbfzv--d-webkit-537-d-ltr-d--s-s-c.css">
	<script type="text/javascript" charset="UTF-8" crossorigin="anonymous">
		window.apmeum||(window.apmeum = {});
		apmeum.dynamicInited||(function(){apmeum.sid='ZDY8llqE0JvP8BQiGtyZDNGTWSWaTguAGrU4DP4OLSTjALGz8qCk!463247378!591928780!1624514124420';
			apmeum.operationId='BBCB021D9D2383089AB8522E9FCE9E902D9298F1';
			apmeum.ecid='005lNmkEVBqFo2KimT1zWJ0006Qh0043Bc';
			apmeum.statusCode='200';
			apmeum.obs=31;
			apmeum.typeobs || (apmeum.typeobs={});
			apmeum.connectionCount=3;
			apmeum.connectionTimeout=2000;
			apmeum.rewriteRules=0;
			apmeum.webapp_tag='';
			apmeum.dynamicInited=true;}());
	</script>
	<script>
		if(window.history && window.history.replaceState) window.history.replaceState(null, null, document.location.href.replace(/_afrLoop=[^&^#]*&*|_afrWindowMode=[^&^#]*&*|Adf-Window-Id=[^&^#]*&*|_afrPage=[^&^#]*&*|_afrRedirect=[^&^#]*&*|Adf-Page-Id=[^&^#]*&*|_afrMT=[^&^#]*&*|_afrFS=[^&^#]*&*|_afrMFW=[^&^#]*&*|_afrMFH=[^&^#]*&*|_afrMFDH=[^&^#]*&*|_afrMFDW=[^&^#]*&*|_afrMFC=[^&^#]*&*|_afrMFCI=[^&^#]*&*|_afrMFM=[^&^#]*&*|_afrMFR=[^&^#]*&*|_afrMFG=[^&^#]*&*|_afrMFS=[^&^#]*&*|_afrMFO=[^&^#]*&*|_afrTC=[^&^#]*&*|/g, '').replace(/[\?&]+$|[\?&]+(?=#)/, ''));
	</script>
	<script type="text/javascript" src="register/js/Localepwuhh9.js"></script>
	<script type="text/javascript" src="register/js/boot-nmkpup.js"></script>
	<script type="text/javascript"></script>
	<script type="text/javascript">
		AdfLogger.DEFAULT_LEVEL=AdfLogger.OFF;
		var checkAgentSupport = false;
		AdfAgent.setInstance(AdfAgent.getAgent(window));
		var lookAndFeel = new AdfDhtmlLookAndFeel(window);
		AdfAgent._LOG_WRITERS = "NativeLogWriter";
		AdfPage.setInstance(lookAndFeel.createPage());
		var page = AdfPage.PAGE;
		page.setBaseResourceUrl("/myprofile");
		page.__setAutomationEnabled(false);
		page.__setCssSelectorsUncompressed(false);
		page.setAnimationEnabled(true);
		page.__setSessionIdentifier('q392indfx');
		page.__setOutputMode('default');
		page.__disableDirtyDataRetainPPR();
		page.setPageProperty("_afrProtectedSearch",false);
	</script>
	<script type="text/javascript" src="register/js/core-d0yor4.js"></script>
	<script type="text/javascript" src="register/js/AdfTranslations-f9vey1_zh_CN.js?loc=zh_CN&amp;skinId=myprofile-skin.desktop"></script>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<script type="text/javascript" language="javascript" src="jquery/jquery-3.5.1.js"></script>
	<script type="text/javascript" language="javascript" src="register/js/branded-logos.js"></script>
	<script type="text/javascript" language="javascript" src="register/js/myprofile-responsive.js"></script>
	<script type="text/javascript" language="javascript" src="register/js/myprofile-utils.js"></script>
	<script id="boomr-scr-as" src="https://s.go-mpulse.net/boomerang/MDKM5-6QFGV-H33ZT-VVTLA-583XF" async=""></script>
</head>
<body class="x2c0 x15z p_AFMaximized" style="cursor: auto;background-image: url(register/img/sso-f17v2-bgimg.jpg)">
<input type="hidden" id="oracle.adf.view.faces.RICH_UPDATE" value="dirty">
<div id="docCreate" class="p_AFHoverTarget">
	<a id="docCreate::skip" href="#" class="x1c7" style="display: none;">跳到主内容</a>
	<span id="afr::ATStatus" class="p_OraHiddenLabel" role="status" aria-live="polite" aria-atomic="true"></span>
	<link type="text/css" rel="stylesheet" href="register/css/jquery-ui-1.8.9.custom.css">
	<link type="text/css" rel="stylesheet" href="register/css/myprofile-responsive.css">
</div>
<div></div>
<div id="content-create" class="wrapper-responsive-create x2c1 x26j xv8">
	<table style="font-size:1px;line-height:1px;height:7px" class="xwu p_AFCore p_AFDefault" cellpadding="0" cellspacing="0" border="0" width="0" summary="" role="presentation">
		<tbody>
		<tr></tr>
		</tbody>
	</table>
	<div class="xxv p_AFCore p_AFDefault">
		<div class="x5s p_AFCore p_AFDefault" id="content-create::content">
			<div id="headeritems" class="x1a"><div><img id="logo" class="branded-logo xl5"></div>
				<div>
					<span class="x289">创建您的 基线检查 帐户</span>
				</div>
				<div>
					<div id="s1" style="margin-top:25px"></div>
				</div>
			</div>
			<span class="x283">已有帐户？</span>
			<a id="signinlink" class="x28h xgp p_AFTextOnly" data-afr-fcs="true" href="login.html" data-afr-tlen="2">
				<span class="x1al">登录</span>
			</a>
			<div id="s4" style="margin-top:15px"></div>
			<span class="x285" style="display:none">* 为必填信息</span>
			<div id="m1" class="x71" style="display:none;" _afrglobalonly="true"></div>
			<div id="s5" style="margin-top:30px"></div>
			<form id="f1" name="f1" class="x15t" method="POST">
                        <span id="usrinf" class="x1a" style="width:100%">
                            <span id="j_id8" class="x1a">
                                <div id="subsecusernamePassword" class="x294 x2c3 x19">
                                    <table cellpadding="0" cellspacing="0" border="0" summary="" role="presentation" style="width: auto">
                                        <tbody>
                                        <tr>
                                            <td class="x4w" colspan="1">
                                            <table cellpadding="0" cellspacing="0" border="0" width="100%" summary="" role="presentation">
                                                <tbody>
                                                <tr>
                                                    <td></td>
                                                    <td></td>
                                                </tr>
                                                <tr class="x27t plm-wrapper xvb" id="usernamePanel">
                                                    <td class="x15 x4z">
                                                        <label class="af_panelLabelAndMessage_label-text">用户名称</label>
                                                    </td>
                                                    <td valign="top" class="xts xvl">
                                                        <table cellpadding="0" cellspacing="0" border="0" summary="" role="presentation">
                                                            <tbody>
                                                            <tr>
                                                                <td>
                                                                    <span id="j_id50" class="x2bu x1a">
                                                                        <span id="username" class="x28p x1u">
                                                                            <input id="username_content" name="username" class="x25" type="text">
                                                                            <label for="username_content" class="x9w">用户名称</label>
                                                                        </span>
                                                                    </span>
                                                                </td>
                                                                <td class="xy0">
                                                                    <span id="usernameinfo" class="x291 helpText-responsive show-desktop">
                                                                        用户名以字母开头，长度为3到20个字符。
                                                                    </span>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="x27t plm-wrapper xvb" id="passwordPanel">
                                                    <td class="x15 x4z">
                                                        <label class="af_panelLabelAndMessage_label-text">密码</label>
                                                    </td>
                                                    <td valign="top" class="xts xvl">
                                                        <table cellpadding="0" cellspacing="0" border="0" summary="" role="presentation">
                                                            <tbody>
                                                            <tr>
                                                                <td>
                                                                    <span id="j_id12" class="x2bu x1a">
                                                                        <span id="password" class="x28m x1u">
                                                                            <input id="password_content" name="password" class="x25" type="password" autocomplete="off">
                                                                            <label for="password_content" class="x9w">密码</label>
                                                                        </span>
                                                                    </span>
                                                                </td>
                                                                <td class="xy0">
                                                                    <span id="passwordinfo" class="x291 helpText-responsive show-desktop">
                                                                        密码长度为6-20个字符，必须同时包含大小写字母以及至少 1 个数字和特殊字符，且不能与用户名相同。
                                                                    </span>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="x27t plm-wrapper xvb" id="retypePasswordPanel">
                                                    <td class="x15 x4z">
                                                        <label class="af_panelLabelAndMessage_label-text">重新键入密码</label>
                                                    </td>
                                                    <td valign="top" class="xts xvl">
                                                        <table cellpadding="0" cellspacing="0" border="0" summary="" role="presentation">
                                                            <tbody>
                                                            <tr>
                                                                <td>
                                                                    <span id="j_id15" class="x2bu x1a">
                                                                        <span id="retypePassword" class="x28m x1u">
                                                                            <input id="retypePassword_content" name="retypePassword" class="x25" type="password" autocomplete="off">
                                                                            <label for="retypePassword_content" class="x9w">重新键入密码</label>
                                                                        </span>
                                                                    </span>
                                                                </td>
                                                                <td class="xy0">
                                                                    <span id="retypePasswordinfo" class="x291 helpText-responsive show-desktop">
                                                                        再次输入密码。
                                                                    </span>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="x27t plm-wrapper xvb" id="workPhonePanel">
                                                    <td class="x15 x4z">
                                                        <label class="af_panelLabelAndMessage_label-text">电话号码</label>
                                                    </td>
                                                    <td valign="top" class="xts xvl">
                                                        <table cellpadding="0" cellspacing="0" border="0" summary="" role="presentation">
                                                            <tbody>
                                                            <tr>
                                                                <td>
                                                                    <span id="j_id52" class="x2bu x1a">
                                                                        <span id="workPhone" class="x28p x1u">
                                                                            <input id="workPhone_content" name="workPhone" class="x25" type="text">
                                                                            <label for="workPhone_content" class="x9w">电话号码</label>
                                                                        </span>
                                                                        <img id="workPhoneSuccessIcon" alt="" class="x2bv xl5" style="display:none" src="/myprofile/images/checkcircle-s.svg">
                                                                    </span>
                                                                </td>
                                                                <td class="xy0">
                                                                    <span id="workPhoneinfo" class="x291 helpText-responsive show-desktop">
                                                                        请输入11位电话号码。
                                                                    </span>
                                                                </td>
                                                            </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="x51">
                                                        <div id="j_id54" style="margin-top:25px"></div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="x51">
                                                        <div id="j_id72" style="margin-top:7px"></div>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td></td>
                                                    <td class="x51">
                                                        <div id="cb1" class="x28x xfn p_AFTextOnly" _afrgrp="0" role="presentation">
                                                            <a href="#" id="registerButton" data-afr-fcs="true" class="xfp" role="button">
                                                                <span class="xfx">创建帐户</span>
                                                            </a>
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                            </table>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </span>
                        </span>
				</span>
			</form>
		</div>
	</div>
	<div class="xxn p_AFCore p_AFDefault"></div>
</div>
<div></div>
<div></div>
<footer class="footer-wrap">
	<a href="javascript:void(0)" target="_blank">帐户帮助</a> |
	<a href="javascript:void(0)" target="_blank">订阅</a> |
	<a href="javascript:void(0)" target="_blank">取消订阅</a> |
	<a href="javascript:void(0)" target="_blank">使用条款和隐私</a>
</footer>
</div>
</div>
</body>
<script>
	$(function () {
		$("#registerButton").click(function () {
			var username = $("#username_content").val();
			var password = $("#password_content").val();
			var phone = $("#workPhone_content").val();
            //checkForm()
            if (checkForm()){
                $.ajax({
                    url:"/shiro/register",
                    type:"post",
                    datatype:"text",
                    data:{
                        username:username,
                        password:password,
                        phone:phone
                    },
                    success:function(response){
                        console.log(response);
                        alert(response.msg);
                        if (response.code === 200){
                            window.location.href="login.html";
                        }
                    },
                    error:function(response){
                        console.log("出错" + response);
                    }
                });
            }
		});

		//表单数据验证
        function checkForm() {
            var name_check = document.getElementById("usernameinfo").innerText;
            var password_check = document.getElementById("passwordinfo").innerText;
            var password2_check = document.getElementById("retypePasswordinfo").innerText;
            var phone_check = document.getElementById("workPhoneinfo").innerText;

            if (name_check === "✔" && password_check === "✔" && password2_check === "✔" && phone_check === "✔"){
                return true;
            }
            else {
                console.log("表单验证不通过");
                return false;
            }
        }

        document.getElementById("username_content").addEventListener("blur",checkName);
        document.getElementById("password_content").addEventListener("blur",checkPassword);
        document.getElementById("retypePassword_content").addEventListener("blur",checkPassword2);
        document.getElementById("workPhone_content").addEventListener("blur",checkPhone);

        function checkName(){
            var name = document.getElementById("username_content").value;
            var nreminder = document.getElementById("usernameinfo");
            var npattern = /^[a-zA-Z]\w{2,21}$/; //以字母开头，匹配字母或下划线或汉字，长度为3-20个字符
            if(npattern.test(name)){
                nreminder.innerText = "✔";
                nreminder.style.color = "green";
                nreminder.style.fontSize = "1.8em";
            }
            else{
                nreminder.innerText = "用户名请以字母开头,长度为3-20个字符";
                nreminder.style.color = "red";
            }
        }
        function checkPassword(){
            var password = document.getElementById("password_content").value;
            var name = document.getElementById("username_content").value;
            var preminder = document.getElementById("passwordinfo");
            var ppattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@$!%*?&])[A-Za-z\d$@$!_%*?&]{5,21}/;
            if(ppattern.test(password)){
                preminder.innerText = "✔";
                preminder.style.color = "green";
                preminder.style.fontSize = "1.8em";
            }
            else if(password==name){
                preminder.innerText = "密码不能与用户名相同";
                preminder.style.color = "red";
            }
            else{
                preminder.innerText = "密码长度为6-20个字符，必须同时包含大小写字母以及至少 1 个数字和特殊字符";
                preminder.style.color = "red";
            }
        }
        function checkPassword2(){
            var password2 = document.getElementById("retypePassword_content").value;
            var password = document.getElementById("password_content").value;
            var preminder2 = document.getElementById("retypePasswordinfo");
            if(password==password2){
                preminder2.innerText = "✔";
                preminder2.style.color = "green";
                preminder2.style.fontSize = "1.8em";
            }
            else{
                preminder2.innerText = "请输入相同的密码";
                preminder2.style.color = "red";
            }
        }
        function checkPhone(){
            var phone = document.getElementById("workPhone_content").value;
            //出现的问题：当使用getElementsByName方法时，下方函数if语句判断结果全部始终为错
            var phreminder = document.getElementById("workPhoneinfo");
            // var ppattern = /^\w+@[a-zA-Z0-9]{2,10}(?:\.[a-z]{2,4}){1,3}$/;
            var phpattern = /[0-9]{11}/;
            if(phpattern.test(phone)){
                phreminder.innerText = "✔";
                phreminder.style.color = "green";
                phreminder.style.fontSize = "1.8em";
            }
            else{
                phreminder.innerText = "电话号码格式错误";
                phreminder.style.color = "red";
            }
        }
	});
</script>
</html>